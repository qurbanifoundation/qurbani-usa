---
interface Props {
  templateName: string;
  templateLabel: string;
}

const { templateName, templateLabel } = Astro.props;
const isUrgentAppeal = templateName === 'urgent-appeal';
---

<div id={`color-editor-${templateName}`} class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
  <div class="bg-white rounded-xl max-w-5xl w-full max-h-[95vh] overflow-hidden">
    <div class="p-4 border-b border-gray-200 flex items-center justify-between">
      <div>
        <h3 class="font-bold text-lg">Customize {templateLabel} Template</h3>
        <p class="text-sm text-gray-500">Click on any element in the preview to edit its color or text</p>
      </div>
      <button onclick={`closeColorEditor('${templateName}')`} class="p-2 hover:bg-gray-100 rounded-lg">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <div class="p-6 overflow-y-auto max-h-[80vh]">
      <form id={`color-form-${templateName}`} class="space-y-6">
        <input type="hidden" name="template_name" value={templateName} />

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- Left: Interactive Live Preview (matches actual frontend) -->
          <div>
            <h4 class="font-medium text-gray-800 mb-3 flex items-center gap-2">
              <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path>
              </svg>
              Live Preview (Click to Edit)
            </h4>

            {isUrgentAppeal ? (
              <!-- URGENT APPEAL Preview - White box with colored header -->
              <div
                id={`preview-${templateName}`}
                class="rounded-2xl overflow-hidden shadow-xl border border-gray-100 transition-all"
                style="background-color: #ffffff;"
              >
                <!-- Colored Header -->
                <div
                  class="p-6 text-center cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all clickable-color-area preview-header"
                  style="background: linear-gradient(135deg, #c41e3a 0%, #c41e3add 100%);"
                  data-template={templateName}
                  data-color-field="header_bg_color"
                  data-color-label="Header Background"
                  title="Click to edit Header Background"
                >
                  <p
                    class="text-sm opacity-80 mb-1 cursor-pointer hover:ring-2 hover:ring-white/50 rounded px-2 py-1 transition-all clickable-text-element preview-subtitle"
                    style="color: #ffffff;"
                    data-template={templateName}
                    data-text-field="subtitle_text"
                    data-text-label="Subtitle Text"
                    title="Click to edit Subtitle"
                  >Your donation saves lives</p>
                  <h3
                    class="text-2xl font-bold cursor-pointer hover:ring-2 hover:ring-white/50 rounded px-2 py-1 transition-all clickable-text-element preview-title"
                    style="color: #ffffff; font-family: 'Signika', sans-serif;"
                    data-template={templateName}
                    data-text-field="title_text"
                    data-text-label="Title Text"
                    title="Click to edit Title"
                  >Campaign Name</h3>
                </div>

                <!-- White Body -->
                <div class="p-6">
                  <!-- Toggle Buttons -->
                  <div
                    class="flex rounded-xl bg-gray-100 p-1 mb-6 cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all clickable-color-element preview-toggle"
                    data-template={templateName}
                    data-color-field="accent_color"
                    data-color-label="Toggle Active Color"
                    title="Click to edit Toggle colors"
                  >
                    <button type="button" class="flex-1 py-3 rounded-lg text-sm font-semibold preview-toggle-active" style="background-color: #c41e3a; color: #ffffff;">
                      One-Time
                    </button>
                    <button type="button" class="flex-1 py-3 rounded-lg text-sm font-semibold preview-toggle-inactive" style="color: #6b7280;">
                      Monthly
                    </button>
                  </div>

                  <!-- Amount Grid (3 columns like actual component) -->
                  <div class="grid grid-cols-3 gap-2 mb-4">
                    <button
                      type="button"
                      class="py-3 px-2 rounded-xl border-2 font-bold preview-btn cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all clickable-color-element text-center"
                      style="background-color: #ffffff; border-color: #e5e7eb; color: #1f2937;"
                      data-template={templateName}
                      data-color-field="border_color"
                      data-color-label="Border Color"
                      title="Click to edit Border"
                    >
                      <span class="text-lg block">$50</span>
                      <span class="text-[10px] text-gray-500 block truncate">Emergency</span>
                    </button>
                    <button
                      type="button"
                      class="py-3 px-2 rounded-xl border-2 font-bold preview-btn cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all clickable-color-element text-center"
                      style="background-color: #ffffff; border-color: #e5e7eb; color: #1f2937;"
                      data-template={templateName}
                      data-color-field="border_color"
                      data-color-label="Border Color"
                      title="Click to edit Border"
                    >
                      <span class="text-lg block">$100</span>
                      <span class="text-[10px] text-gray-500 block truncate">Food pack</span>
                    </button>
                    <button
                      type="button"
                      class="py-3 px-2 rounded-xl border-2 font-bold preview-btn-active cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all clickable-color-element text-center"
                      style="background-color: rgba(196,30,58,0.1); border-color: #c41e3a; color: #1f2937;"
                      data-template={templateName}
                      data-color-field="active_bg_color"
                      data-color-label="Selected Amount BG"
                      title="Click to edit Selected colors"
                    >
                      <span class="text-lg block">$250</span>
                      <span class="text-[10px] text-gray-500 block truncate">Medical aid</span>
                    </button>
                    <button
                      type="button"
                      class="py-3 px-2 rounded-xl border-2 font-bold preview-btn cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all clickable-color-element text-center"
                      style="background-color: #ffffff; border-color: #e5e7eb; color: #1f2937;"
                      data-template={templateName}
                      data-color-field="border_color"
                      data-color-label="Border Color"
                      title="Click to edit Border"
                    >
                      <span class="text-lg block">$500</span>
                      <span class="text-[10px] text-gray-500 block truncate">Family support</span>
                    </button>
                    <button
                      type="button"
                      class="py-3 px-2 rounded-xl border-2 font-bold preview-btn cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all clickable-color-element text-center"
                      style="background-color: #ffffff; border-color: #e5e7eb; color: #1f2937;"
                      data-template={templateName}
                      data-color-field="border_color"
                      data-color-label="Border Color"
                      title="Click to edit Border"
                    >
                      <span class="text-lg block">$1000</span>
                      <span class="text-[10px] text-gray-500 block truncate">Major impact</span>
                    </button>
                    <button
                      type="button"
                      class="py-3 px-2 rounded-xl border-2 font-bold preview-btn cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all clickable-color-element text-center"
                      style="background-color: #ffffff; border-color: #e5e7eb; color: #1f2937;"
                      data-template={templateName}
                      data-color-field="border_color"
                      data-color-label="Border Color"
                      title="Click to edit Border"
                    >
                      <span class="text-lg block">$2500</span>
                      <span class="text-[10px] text-gray-500 block truncate">Save lives</span>
                    </button>
                  </div>

                  <!-- Custom Amount Input -->
                  <div class="relative mb-6">
                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-lg font-bold text-gray-400">$</span>
                    <input
                      type="text"
                      readonly
                      class="w-full pl-10 pr-4 py-4 rounded-xl border-2 font-bold text-lg cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all preview-custom-input"
                      style="border-color: #e5e7eb; color: #374151; background-color: #ffffff;"
                      placeholder="Other amount"
                    />
                  </div>

                  <!-- Donate Button -->
                  <button
                    type="button"
                    class="w-full py-4 rounded-xl font-bold text-lg preview-donate-btn cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all clickable-text-element flex items-center justify-center gap-2"
                    style="background-color: #c41e3a; color: #ffffff; box-shadow: 0 4px 20px rgba(196,30,58,0.3);"
                    data-template={templateName}
                    data-color-field="accent_color"
                    data-color-label="Donate Button Color"
                    data-secondary-field="accent_text_color"
                    data-secondary-label="Donate Button Text Color"
                    data-text-field="button_text"
                    data-text-label="Button Text"
                    title="Click to edit Donate Button"
                  >
                    Donate Now
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                    </svg>
                  </button>

                  <!-- Trust Badges -->
                  <div class="mt-6 pt-6 border-t border-gray-100">
                    <div class="flex justify-center gap-6 text-center">
                      <div class="text-xs flex flex-col items-center gap-1 text-gray-500">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"></path>
                        </svg>
                        <span>Secure</span>
                      </div>
                      <div class="text-xs flex flex-col items-center gap-1 text-gray-500">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <span>Tax Deductible</span>
                      </div>
                      <div class="text-xs flex flex-col items-center gap-1 text-gray-500">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                        </svg>
                        <span>100% Policy</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            ) : (
              <!-- DEFAULT Preview - Teal box style -->
              <div
                id={`preview-${templateName}`}
                class="rounded-2xl p-6 transition-all relative"
                style="background-color: #255764;"
              >
              <!-- Clickable overlay for background -->
              <div
                class="absolute inset-0 rounded-2xl cursor-pointer hover:ring-2 hover:ring-blue-400 hover:ring-offset-2 transition-all clickable-color-area"
                data-template={templateName}
                data-color-field="bg_color"
                data-color-label="Box Background"
                title="Click to edit Box Background"
              ></div>

              <div class="relative z-10">
                <!-- Header - Stacked vertically like frontend -->
                <div class="text-center mb-5">
                  <h3
                    class="font-bold mb-1 cursor-pointer hover:ring-2 hover:ring-blue-400 rounded px-2 py-1 transition-all clickable-text-element preview-title"
                    style="color: #ffffff; font-size: 1.25rem;"
                    data-template={templateName}
                    data-color-field="text_color"
                    data-color-label="Title Text Color"
                    data-text-field="title_text"
                    data-text-label="Title Text"
                    title="Click to edit Title"
                  >Campaign Name</h3>
                  <p
                    class="cursor-pointer hover:ring-2 hover:ring-blue-400 rounded px-2 py-1 transition-all clickable-text-element preview-subtitle"
                    style="color: rgba(255,255,255,0.7); font-size: 0.875rem;"
                    data-template={templateName}
                    data-color-field="text_muted_color"
                    data-color-label="Subtitle Color"
                    data-text-field="subtitle_text"
                    data-text-label="Subtitle Text"
                    title="Click to edit Subtitle"
                  >100% reaches those in need</p>
                </div>

                <!-- Toggle Buttons -->
                <div
                  class="flex rounded-xl p-1 mb-5 cursor-pointer hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 transition-all clickable-color-element preview-toggle"
                  style="background-color: rgba(255,255,255,0.1);"
                  data-template={templateName}
                  data-color-field="toggle_active_color"
                  data-color-label="Toggle Active Color"
                  title="Click to edit Toggle colors"
                >
                  <button type="button" class="flex-1 py-2.5 px-4 rounded-lg text-sm font-semibold transition-all preview-toggle-active" style="background-color: rgba(255,255,255,0.2); color: #ffffff;">
                    Single
                  </button>
                  <button type="button" class="flex-1 py-2.5 px-4 rounded-lg text-sm font-semibold preview-toggle-inactive" style="color: rgba(255,255,255,0.7);">
                    Monthly
                  </button>
                </div>

                <!-- Amount Grid (2 columns like frontend) -->
                <div class="grid grid-cols-2 gap-3 mb-5">
                  <button
                    type="button"
                    class="py-4 px-3 rounded-xl border-2 font-semibold preview-btn-active cursor-pointer hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 transition-all clickable-color-element text-center"
                    style="background-color: rgba(253,196,72,0.2); border-color: #fdc448; color: #ffffff;"
                    data-template={templateName}
                    data-color-field="active_bg_color"
                    data-color-label="Selected Amount BG"
                    data-secondary-field="active_text_color"
                    data-secondary-label="Selected Amount Text"
                    title="Click to edit Selected Amount colors"
                  >
                    <span class="text-lg block">$300</span>
                    <span class="text-xs opacity-70 block mt-1">Water Hand Pump</span>
                  </button>
                  <button
                    type="button"
                    class="py-4 px-3 rounded-xl border-2 font-semibold preview-btn cursor-pointer hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 transition-all clickable-color-element text-center"
                    style="background-color: transparent; border-color: rgba(255,255,255,0.3); color: #ffffff;"
                    data-template={templateName}
                    data-color-field="inactive_btn_bg"
                    data-color-label="Inactive Button BG"
                    data-secondary-field="border_color"
                    data-secondary-label="Border Color"
                    title="Click to edit Inactive Button colors"
                  >
                    <span class="text-lg block">$400</span>
                    <span class="text-xs opacity-70 block mt-1">Electric Water Well</span>
                  </button>
                  <button
                    type="button"
                    class="py-4 px-3 rounded-xl border-2 font-semibold preview-btn cursor-pointer hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 transition-all clickable-color-element text-center"
                    style="background-color: transparent; border-color: rgba(255,255,255,0.3); color: #ffffff;"
                    data-template={templateName}
                    data-color-field="inactive_btn_bg"
                    data-color-label="Inactive Button BG"
                    title="Click to edit Inactive Button BG"
                  >
                    <span class="text-lg block">$600</span>
                    <span class="text-xs opacity-70 block mt-1">Water Well</span>
                  </button>
                  <button
                    type="button"
                    class="py-4 px-3 rounded-xl border-2 font-semibold preview-btn cursor-pointer hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 transition-all clickable-color-element text-center"
                    style="background-color: transparent; border-color: rgba(255,255,255,0.3); color: #ffffff;"
                    data-template={templateName}
                    data-color-field="inactive_btn_bg"
                    data-color-label="Inactive Button BG"
                    title="Click to edit Inactive Button BG"
                  >
                    <span class="text-lg block">$3,500</span>
                    <span class="text-xs opacity-70 block mt-1">Solar Community Well</span>
                  </button>
                </div>

                <!-- Custom Amount Input -->
                <div class="relative mb-5">
                  <span class="absolute left-4 top-1/2 -translate-y-1/2 text-lg font-bold" style="color: rgba(255,255,255,0.5);">$</span>
                  <input
                    type="text"
                    readonly
                    class="w-full pl-10 pr-4 py-3 rounded-xl border-2 font-bold text-lg bg-white cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all clickable-color-element preview-custom-input"
                    style="border-color: rgba(255,255,255,0.3); color: #374151;"
                    placeholder="Any Amount"
                    data-template={templateName}
                    data-color-field="border_color"
                    data-color-label="Border Color"
                    title="Click to edit Border Color"
                  />
                </div>

                <!-- Donate Button -->
                <button
                  type="button"
                  class="w-full py-4 rounded-xl font-bold text-lg preview-donate-btn cursor-pointer hover:ring-2 hover:ring-blue-400 hover:ring-offset-1 transition-all clickable-text-element"
                  style="background-color: #fdc448; color: #61470e; box-shadow: 3px 4px 0 rgba(0,0,0,0.2);"
                  data-template={templateName}
                  data-color-field="accent_color"
                  data-color-label="Donate Button Color"
                  data-secondary-field="accent_text_color"
                  data-secondary-label="Donate Button Text Color"
                  data-text-field="button_text"
                  data-text-label="Button Text"
                  title="Click to edit Donate Button"
                >
                  <span class="donate-btn-text">Donate Now</span>
                </button>

                <!-- Trust Badges -->
                <div class="mt-4 pt-4 border-t" style="border-color: rgba(255,255,255,0.2);">
                  <div class="flex justify-center gap-6 text-center">
                    <div class="text-xs flex items-center gap-1 cursor-pointer hover:ring-2 hover:ring-blue-400 rounded px-2 py-1 clickable-color-element" style="color: rgba(255,255,255,0.6);" data-template={templateName} data-color-field="text_muted_color" data-color-label="Muted Text Color" title="Click to edit badge color">
                      <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"></path>
                      </svg>
                      <span>Secure</span>
                    </div>
                    <div class="text-xs flex items-center gap-1" style="color: rgba(255,255,255,0.6);">
                      <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                      </svg>
                      <span>Tax Deductible</span>
                    </div>
                    <div class="text-xs flex items-center gap-1" style="color: rgba(255,255,255,0.6);">
                      <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                      </svg>
                      <span>100% Policy</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            )}
          </div>

          <!-- Right: Settings Panels -->
          <div class="space-y-4">
            <!-- Text Settings -->
            <details class="border border-gray-200 rounded-lg" open>
              <summary class="px-4 py-3 cursor-pointer font-medium text-gray-700 hover:bg-gray-50 rounded-lg flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                </svg>
                Text & Labels
              </summary>
              <div class="p-4 border-t border-gray-200 space-y-4">
                <!-- Title Text -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Title Text</label>
                  <input type="text" name="title_text" value="{campaign}" placeholder="{campaign}" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                  <p class="text-xs text-gray-400 mt-1">Use <code class="bg-gray-100 px-1 rounded">{'{campaign}'}</code> to show the campaign name</p>
                </div>

                <!-- Subtitle Text -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Subtitle Text</label>
                  <input type="text" name="subtitle_text" value="100% reaches those in need" placeholder="100% reaches those in need" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                  <p class="text-xs text-gray-400 mt-1">You can also use <code class="bg-gray-100 px-1 rounded">{'{campaign}'}</code> here</p>
                </div>

                <!-- Button Text -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Donate Button Text</label>
                  <input type="text" name="button_text" value="Donate Now" placeholder="Donate Now" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                </div>

                <!-- Single Payment Text -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Single Payment Label</label>
                  <input type="text" name="single_text" value="Single" placeholder="Single" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                </div>

                <!-- Monthly Payment Text -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Monthly Payment Label</label>
                  <input type="text" name="monthly_text" value="Monthly" placeholder="Monthly" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                </div>

                <!-- Custom Amount Placeholder -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Custom Amount Placeholder</label>
                  <input type="text" name="custom_amount_placeholder" value="Any Amount" placeholder="Any Amount" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                </div>
              </div>
            </details>

            <!-- Font Sizes -->
            <details class="border border-gray-200 rounded-lg">
              <summary class="px-4 py-3 cursor-pointer font-medium text-gray-700 hover:bg-gray-50 rounded-lg flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
                </svg>
                Font Sizes
              </summary>
              <div class="p-4 border-t border-gray-200 space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Title Size</label>
                  <select name="title_size" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" onchange={`updateFontSize('${templateName}', 'title', this.value)`}>
                    <option value="text-lg">Medium</option>
                    <option value="text-xl" selected>Large</option>
                    <option value="text-2xl">Extra Large</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Subtitle Size</label>
                  <select name="subtitle_size" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" onchange={`updateFontSize('${templateName}', 'subtitle', this.value)`}>
                    <option value="text-xs">Extra Small</option>
                    <option value="text-sm" selected>Small</option>
                    <option value="text-base">Medium</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Button Text Size</label>
                  <select name="button_size" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" onchange={`updateFontSize('${templateName}', 'button', this.value)`}>
                    <option value="text-sm">Small</option>
                    <option value="text-base">Medium</option>
                    <option value="text-lg" selected>Large</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Amount Button Size</label>
                  <select name="amount_size" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" onchange={`updateFontSize('${templateName}', 'amount', this.value)`}>
                    <option value="text-sm">Small</option>
                    <option value="text-base">Medium</option>
                    <option value="text-lg" selected>Large</option>
                  </select>
                </div>
              </div>
            </details>

            <!-- Default Donation Amounts -->
            <details class="border border-gray-200 rounded-lg">
              <summary class="px-4 py-3 cursor-pointer font-medium text-gray-700 hover:bg-gray-50 rounded-lg flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                Default Donation Amounts
              </summary>
              <div class="p-4 border-t border-gray-200 space-y-4">
                <p class="text-xs text-gray-500 mb-3">These amounts are used when a campaign doesn't have its own donation options set.</p>
                <div id={`amounts-container-${templateName}`} class="space-y-3">
                  <!-- Amount rows will be populated by JavaScript -->
                  <div class="amount-row flex gap-2 items-center">
                    <input type="number" name="amount_1" value="30" placeholder="Amount" class="w-24 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                    <input type="text" name="label_1" value="support for local, vetted nonprofit organizations worldwide" placeholder="Description" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                  </div>
                  <div class="amount-row flex gap-2 items-center">
                    <input type="number" name="amount_2" value="50" placeholder="Amount" class="w-24 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                    <input type="text" name="label_2" value="support for local, vetted nonprofit organizations worldwide" placeholder="Description" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                  </div>
                  <div class="amount-row flex gap-2 items-center">
                    <input type="number" name="amount_3" value="80" placeholder="Amount" class="w-24 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                    <input type="text" name="label_3" value="support for local, vetted nonprofit organizations worldwide" placeholder="Description" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                  </div>
                  <div class="amount-row flex gap-2 items-center">
                    <input type="number" name="amount_4" value="100" placeholder="Amount" class="w-24 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                    <input type="text" name="label_4" value="support for local, vetted nonprofit organizations worldwide" placeholder="Description" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                  </div>
                  <div class="amount-row flex gap-2 items-center">
                    <input type="number" name="amount_5" value="250" placeholder="Amount" class="w-24 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                    <input type="text" name="label_5" value="support for local, vetted nonprofit organizations worldwide" placeholder="Description" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                  </div>
                  <div class="amount-row flex gap-2 items-center">
                    <input type="number" name="amount_6" value="1000" placeholder="Amount" class="w-24 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                    <input type="text" name="label_6" value="support for local, vetted nonprofit organizations worldwide" placeholder="Description" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                  </div>
                </div>
                <p class="text-xs text-gray-400">Leave amount empty to remove that option. Amounts are shown in the order listed.</p>
              </div>
            </details>

            <!-- Trust Message (List Style only) -->
            <details class="border border-gray-200 rounded-lg">
              <summary class="px-4 py-3 cursor-pointer font-medium text-gray-700 hover:bg-gray-50 rounded-lg flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                </svg>
                Trust Message (List Style)
              </summary>
              <div class="p-4 border-t border-gray-200 space-y-4">
                <p class="text-xs text-gray-500 mb-3">This message appears at the bottom of the List Style donation box.</p>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Trust Message Text</label>
                  <textarea
                    name="trust_message_text"
                    rows="2"
                    placeholder="Donating through Qurbani Foundation is safe, secure, and easy with many payment options to choose from."
                    class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm"
                  >Donating through Qurbani Foundation is safe, secure, and easy with many payment options to choose from.</textarea>
                </div>
                <div class="grid grid-cols-2 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Link Text</label>
                    <input type="text" name="trust_link_text" value="View other ways to donate" placeholder="View other ways to donate" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Link URL</label>
                    <input type="text" name="trust_link_url" value="/donate" placeholder="/donate" class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" />
                  </div>
                </div>
              </div>
            </details>

            <!-- Color Settings -->
            <details class="border border-gray-200 rounded-lg">
              <summary class="px-4 py-3 cursor-pointer font-medium text-gray-700 hover:bg-gray-50 rounded-lg flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                </svg>
                All Color Settings
              </summary>
              <div class="p-4 border-t border-gray-200">
                <div class="grid grid-cols-1 gap-3">
                  <!-- Box Background -->
                  <div id={`field-bg_color-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="bg_color" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="bg_color_text" placeholder="#255764" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Background</span>
                  </div>

                  <!-- Header Background (for urgent-appeal) -->
                  <div id={`field-header_bg_color-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="header_bg_color" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="header_bg_color_text" placeholder="#c41e3a" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Header BG</span>
                  </div>

                  <!-- Text Color -->
                  <div id={`field-text_color-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="text_color" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="text_color_text" placeholder="#ffffff" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Title Text</span>
                  </div>

                  <!-- Muted Text Color -->
                  <div id={`field-text_muted_color-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="text_muted_color" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="text_muted_color_text" placeholder="rgba(255,255,255,0.7)" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Subtitle/Muted</span>
                  </div>

                  <!-- Donate Button Color -->
                  <div id={`field-accent_color-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="accent_color" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="accent_color_text" placeholder="#fdc448" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Donate Button</span>
                  </div>

                  <!-- Donate Button Text -->
                  <div id={`field-accent_text_color-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="accent_text_color" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="accent_text_color_text" placeholder="#61470e" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Button Text</span>
                  </div>

                  <!-- Border Color -->
                  <div id={`field-border_color-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="border_color" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="border_color_text" placeholder="rgba(255,255,255,0.3)" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Border</span>
                  </div>

                  <!-- Selected Amount BG -->
                  <div id={`field-active_bg_color-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="active_bg_color" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="active_bg_color_text" placeholder="rgba(253,196,72,0.2)" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Selected BG</span>
                  </div>

                  <!-- Selected Amount Text -->
                  <div id={`field-active_text_color-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="active_text_color" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="active_text_color_text" placeholder="#ffffff" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Selected Text</span>
                  </div>

                  <!-- Inactive Button BG -->
                  <div id={`field-inactive_btn_bg-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="inactive_btn_bg" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="inactive_btn_bg_text" placeholder="transparent" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Inactive BG</span>
                  </div>

                  <!-- Toggle Active Color -->
                  <div id={`field-toggle_active_color-${templateName}`} class="color-field-group flex items-center gap-3">
                    <input type="color" name="toggle_active_color" class="w-10 h-8 rounded border cursor-pointer flex-shrink-0" />
                    <input type="text" name="toggle_active_color_text" placeholder="rgba(255,255,255,0.2)" class="flex-1 px-2 py-1.5 border border-gray-200 rounded text-sm" />
                    <span class="text-xs text-gray-500 w-28">Toggle Active</span>
                  </div>
                </div>
              </div>
            </details>
          </div>
        </div>

        <!-- Color Picker Popup (hidden by default) -->
        <div id={`color-picker-popup-${templateName}`} class="hidden fixed bg-white rounded-xl shadow-2xl border border-gray-200 p-4 z-[60]" style="min-width: 300px;">
          <div class="flex items-center justify-between mb-3">
            <h5 id={`color-picker-label-${templateName}`} class="font-semibold text-gray-800">Edit</h5>
            <button type="button" onclick={`closeColorPicker('${templateName}')`} class="p-1 hover:bg-gray-100 rounded">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          <div id={`color-picker-fields-${templateName}`} class="space-y-3">
            <!-- Dynamic fields will be inserted here -->
          </div>
        </div>
      </form>
    </div>

    <div class="p-4 border-t border-gray-200 flex justify-between">
      <button onclick={`resetAllColors('${templateName}')`} class="px-4 py-2 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 flex items-center gap-2" title="Reset all colors to their default values">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
        Reset All Colors
      </button>
      <div class="flex gap-3">
        <button onclick={`closeColorEditor('${templateName}')`} class="px-4 py-2 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50">
          Cancel
        </button>
        <button onclick={`saveTemplateColors('${templateName}')`} class="px-4 py-2 bg-[#01534d] text-white rounded-lg text-sm font-medium hover:bg-[#013d39]">
          Save Changes
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  .clickable-color-element:hover,
  .clickable-color-area:hover,
  .clickable-text-element:hover {
    cursor: pointer;
  }

  .color-field-group.highlight {
    background-color: #fef3c7;
    border-radius: 0.375rem;
    padding: 0.25rem;
    margin: -0.25rem;
    animation: pulse-highlight 1s ease-in-out;
  }

  @keyframes pulse-highlight {
    0%, 100% { background-color: #fef3c7; }
    50% { background-color: #fde68a; }
  }

  /* Ensure text is always visible in preview with subtle shadow for contrast */
  .preview-title,
  .preview-subtitle {
    text-shadow:
      0 0 2px rgba(0,0,0,0.3),
      0 0 4px rgba(255,255,255,0.3);
  }

  /* Add dashed outline to elements that might be invisible */
  .preview-btn,
  .preview-btn-active,
  .preview-toggle,
  .preview-custom-input {
    outline: 1px dashed rgba(128,128,128,0.3);
    outline-offset: -1px;
  }
</style>
