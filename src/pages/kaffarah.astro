---
/**
 * Kaffarah Page
 * Explains Kaffarah (expiation) and provides donation options ($300 for 60 days)
 */
export const prerender = false;

import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
---

<Layout title="Pay Kaffarah - Qurbani Foundation USA" description="Pay your Kaffarah online. $300 to feed 60 people as expiation for deliberately breaking a fast without a valid reason.">
  <Navbar />

  <!-- Hero Section -->
  <section class="relative pt-24 pb-20 overflow-hidden">
    <!-- Background gradient -->
    <div class="absolute inset-0 bg-gradient-to-br from-[#991b1b] via-[#dc2626] to-[#ef4444]"></div>
    <!-- Decorative pattern -->
    <div class="absolute inset-0 opacity-10">
      <div class="absolute inset-0" style="background-image: url('data:image/svg+xml,%3Csvg width=\"60\" height=\"60\" viewBox=\"0 0 60 60\" xmlns=\"http://www.w3.org/2000/svg\"%3E%3Cg fill=\"none\" fill-rule=\"evenodd\"%3E%3Cg fill=\"%23ffffff\" fill-opacity=\"0.4\"%3E%3Cpath d=\"M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>
    </div>

    <div class="relative z-10 max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center max-w-3xl mx-auto">
        <!-- Breadcrumb -->
        <div class="flex items-center justify-center gap-2 text-white/60 text-sm mb-6">
          <a href="/" class="hover:text-white transition">Home</a>
          <span>/</span>
          <a href="/ramadan" class="hover:text-white transition">Ramadan 2026</a>
          <span>/</span>
          <span class="text-white">Kaffarah</span>
        </div>

        <!-- Icon -->
        <div class="w-20 h-20 mx-auto mb-6 bg-white/10 rounded-full flex items-center justify-center backdrop-blur-sm border border-white/20">
          <svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
          </svg>
        </div>

        <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-6" style="font-family: 'Signika', sans-serif;">
          Pay Your <span class="text-[#fdc448]">Kaffarah</span>
        </h1>

        <p class="text-lg md:text-xl text-white/90 mb-4 leading-relaxed" style="font-family: 'Lato', sans-serif;">
          Expiation for deliberately breaking your fast
        </p>

        <div class="inline-block bg-white/20 backdrop-blur-sm text-white text-xl font-bold px-6 py-3 rounded-full border border-white/30">
          $300 (60 people)
        </div>
      </div>
    </div>

    <!-- Wave divider -->
    <div class="absolute bottom-0 left-0 right-0">
      <svg viewBox="0 0 1440 120" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" class="w-full h-16">
        <path d="M0 120L60 110C120 100 240 80 360 70C480 60 600 60 720 65C840 70 960 80 1080 85C1200 90 1320 90 1380 90L1440 90V120H1380C1320 120 1200 120 1080 120C960 120 840 120 720 120C600 120 480 120 360 120C240 120 120 120 60 120H0Z" fill="white"/>
      </svg>
    </div>
  </section>

  <!-- Main Content -->
  <section class="py-16 bg-white">
    <div class="max-w-[1200px] mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-2 gap-12 items-start">
        <!-- Left Column - Information -->
        <div>
          <h2 class="text-3xl font-bold text-gray-800 mb-6" style="font-family: 'Signika', sans-serif;">
            What is <span class="text-[#dc2626]">Kaffarah</span>?
          </h2>

          <div class="prose prose-lg max-w-none text-gray-600" style="font-family: 'Lato', sans-serif;">
            <p class="mb-4">
              Kaffarah is a penalty or expiation that must be paid when a Muslim deliberately breaks their fast during Ramadan without a valid reason. It is a serious matter in Islamic jurisprudence as fasting during Ramadan is one of the five pillars of Islam.
            </p>

            <p class="mb-6">
              The Kaffarah requires feeding <strong>60 poor people</strong> for each fast that was deliberately broken. This is equivalent to $300 per day broken, based on the cost of providing meals to 60 individuals.
            </p>

            <div class="bg-[#dc2626]/10 border-l-4 border-[#dc2626] p-4 rounded-r-lg mb-6">
              <p class="text-sm text-gray-700 font-semibold mb-2">Important:</p>
              <p class="text-sm text-gray-700">
                Kaffarah is different from Fidya. Kaffarah is only required when someone deliberately breaks their fast without any valid Islamic excuse. If you missed a fast due to illness, travel, or other valid reasons, you should pay Fidya instead.
              </p>
            </div>

            <h3 class="text-xl font-bold text-gray-800 mb-4" style="font-family: 'Signika', sans-serif;">
              When is Kaffarah Required?
            </h3>

            <ul class="space-y-3 mb-6">
              <li class="flex items-start gap-3">
                <svg class="w-6 h-6 text-[#dc2626] flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                <span>Deliberately eating or drinking during fasting hours without a valid excuse</span>
              </li>
              <li class="flex items-start gap-3">
                <svg class="w-6 h-6 text-[#dc2626] flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                <span>Intentionally breaking the fast knowing it is obligatory</span>
              </li>
              <li class="flex items-start gap-3">
                <svg class="w-6 h-6 text-[#dc2626] flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                <span>Other deliberate violations of the fast without necessity</span>
              </li>
            </ul>

            <h3 class="text-xl font-bold text-gray-800 mb-4" style="font-family: 'Signika', sans-serif;">
              The Order of Kaffarah Expiation
            </h3>

            <p class="mb-4">
              According to Islamic scholars, Kaffarah should be fulfilled in the following order:
            </p>

            <ol class="list-decimal list-inside space-y-2 mb-6 pl-4">
              <li><strong>Freeing a slave</strong> - This is no longer applicable in modern times</li>
              <li><strong>Fasting for 60 consecutive days</strong> - If unable to free a slave</li>
              <li><strong>Feeding 60 poor people</strong> - If unable to fast for 60 days</li>
            </ol>

            <p class="mb-6">
              Most scholars agree that in today's context, the primary method of paying Kaffarah is by feeding 60 poor people, as freeing a slave is no longer applicable and many people are unable to fast for 60 consecutive days.
            </p>

            <div class="bg-gray-50 rounded-xl p-6 mb-6">
              <h4 class="font-bold text-gray-800 mb-3">Kaffarah Calculation:</h4>
              <ul class="space-y-2 text-sm">
                <li>1 day broken = Feed 60 people = <strong>$300</strong></li>
                <li>$5 per person x 60 people = $300</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Right Column - Donation Box -->
        <div class="lg:sticky lg:top-24">
          <div class="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden">
            <div class="bg-gradient-to-r from-[#dc2626] to-[#ef4444] p-6 text-center">
              <h3 class="text-2xl font-bold text-white mb-2" style="font-family: 'Signika', sans-serif;">
                Pay Your Kaffarah
              </h3>
              <p class="text-white/80 text-sm">$300 per day (feeds 60 people)</p>
            </div>

            <div class="p-6">
              <!-- Days Selection -->
              <div class="mb-6">
                <label class="block text-sm font-semibold text-gray-700 mb-3">Number of Days to Expiate</label>
                <div class="grid grid-cols-4 gap-2 mb-3">
                  <button class="kaffarah-days-btn py-3 border-2 border-[#dc2626] rounded-lg bg-[#dc2626]/10 text-[#dc2626] font-bold text-sm" data-days="1">1</button>
                  <button class="kaffarah-days-btn py-3 border-2 border-gray-200 rounded-lg bg-white text-gray-700 font-bold text-sm hover:border-[#dc2626] transition" data-days="2">2</button>
                  <button class="kaffarah-days-btn py-3 border-2 border-gray-200 rounded-lg bg-white text-gray-700 font-bold text-sm hover:border-[#dc2626] transition" data-days="5">5</button>
                  <button class="kaffarah-days-btn py-3 border-2 border-gray-200 rounded-lg bg-white text-gray-700 font-bold text-sm hover:border-[#dc2626] transition" data-days="10">10</button>
                </div>
                <div class="relative">
                  <input type="number" id="kaffarah-custom-days" min="1" placeholder="Custom days" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#dc2626] focus:border-[#dc2626] outline-none transition" />
                </div>
              </div>

              <!-- Total Amount -->
              <div class="bg-[#dc2626]/10 rounded-xl p-4 mb-6 text-center">
                <p class="text-sm text-gray-600 mb-1">Total Amount</p>
                <p class="text-4xl font-bold text-[#dc2626]" id="kaffarah-total">$300</p>
                <p class="text-xs text-gray-500 mt-1"><span id="kaffarah-days-display">1</span> day(s) x $300 (60 people each)</p>
              </div>

              <!-- Breakdown -->
              <div class="bg-gray-50 rounded-lg p-4 mb-6">
                <p class="text-xs text-gray-500 mb-2">This will provide:</p>
                <p class="text-lg font-bold text-gray-800"><span id="kaffarah-people-count">60</span> meals</p>
                <p class="text-xs text-gray-500">to people in need</p>
              </div>

              <!-- Add to Cart Button -->
              <button
                id="kaffarah-add-to-cart"
                class="w-full bg-[#dc2626] hover:bg-[#b91c1c] text-white font-bold py-4 rounded-xl transition-all hover:scale-[1.02] flex items-center justify-center gap-2"
                style="font-family: 'Signika', sans-serif; box-shadow: 0 4px 15px rgba(220, 38, 38, 0.3);"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>
                </svg>
                Add Kaffarah to Cart
              </button>

              <p class="text-center text-xs text-gray-500 mt-4">
                100% of your Kaffarah reaches those in need
              </p>
            </div>
          </div>

          <!-- Quick Links -->
          <div class="mt-6 bg-gray-50 rounded-xl p-4">
            <p class="text-sm font-semibold text-gray-700 mb-3">Other Ramadan Giving:</p>
            <div class="space-y-2">
              <a href="/fidya" class="flex items-center justify-between p-3 bg-white rounded-lg hover:shadow-md transition">
                <span class="text-sm font-medium text-gray-700">Fidya</span>
                <span class="text-xs text-gray-500">$10/day</span>
              </a>
              <a href="/zakat-ul-fitr" class="flex items-center justify-between p-3 bg-white rounded-lg hover:shadow-md transition">
                <span class="text-sm font-medium text-gray-700">Zakat ul-Fitr</span>
                <span class="text-xs text-gray-500">$15/person</span>
              </a>
              <a href="/iftar" class="flex items-center justify-between p-3 bg-white rounded-lg hover:shadow-md transition">
                <span class="text-sm font-medium text-gray-700">Feed Iftar</span>
                <span class="text-xs text-gray-500">$5/meal</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Difference Section -->
  <section class="py-16 bg-[#f8f9fa]">
    <div class="max-w-[1000px] mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center" style="font-family: 'Signika', sans-serif;">
        Fidya vs Kaffarah: Understanding the Difference
      </h2>

      <div class="grid md:grid-cols-2 gap-8">
        <!-- Fidya -->
        <div class="bg-white rounded-2xl p-6 shadow-sm border-2 border-[#16a34a]/20">
          <div class="w-12 h-12 bg-[#16a34a]/10 rounded-xl flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-[#16a34a]" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold text-[#16a34a] mb-3" style="font-family: 'Signika', sans-serif;">Fidya</h3>
          <ul class="space-y-2 text-sm text-gray-600">
            <li class="flex items-start gap-2">
              <span class="text-[#16a34a] font-bold">-</span>
              <span>For those <strong>unable</strong> to fast due to valid reasons</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-[#16a34a] font-bold">-</span>
              <span>Includes illness, old age, pregnancy, nursing</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-[#16a34a] font-bold">-</span>
              <span>Cannot make up the fasts later</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-[#16a34a] font-bold">-</span>
              <span><strong>$10 per day</strong> (feeds 1 person two meals)</span>
            </li>
          </ul>
          <a href="/fidya" class="inline-flex items-center gap-2 text-[#16a34a] font-semibold text-sm mt-4 hover:gap-3 transition-all">
            Pay Fidya
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
        </div>

        <!-- Kaffarah -->
        <div class="bg-white rounded-2xl p-6 shadow-sm border-2 border-[#dc2626]/20">
          <div class="w-12 h-12 bg-[#dc2626]/10 rounded-xl flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-[#dc2626]" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold text-[#dc2626] mb-3" style="font-family: 'Signika', sans-serif;">Kaffarah</h3>
          <ul class="space-y-2 text-sm text-gray-600">
            <li class="flex items-start gap-2">
              <span class="text-[#dc2626] font-bold">-</span>
              <span>For <strong>deliberately breaking</strong> the fast</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-[#dc2626] font-bold">-</span>
              <span>No valid Islamic excuse for breaking</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-[#dc2626] font-bold">-</span>
              <span>Intentional violation of the fast</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-[#dc2626] font-bold">-</span>
              <span><strong>$300 per day</strong> (feeds 60 people)</span>
            </li>
          </ul>
          <span class="inline-flex items-center gap-2 text-[#dc2626] font-semibold text-sm mt-4">
            You are here
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
            </svg>
          </span>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-16 bg-gradient-to-br from-[#dc2626] to-[#991b1b] relative overflow-hidden">
    <div class="absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2"></div>
    <div class="absolute bottom-0 left-0 w-48 h-48 bg-white/10 rounded-full translate-y-1/2 -translate-x-1/2"></div>

    <div class="relative z-10 max-w-4xl mx-auto px-4 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-6" style="font-family: 'Signika', sans-serif;">
        Seek Forgiveness Through Charity
      </h2>
      <p class="text-lg text-white/80 mb-8 max-w-2xl mx-auto">
        Your Kaffarah provides meals for 60 people in need. Turn your expiation into an opportunity to help others.
      </p>
      <a
        href="/ramadan"
        class="inline-flex items-center gap-2 bg-white hover:bg-gray-100 text-[#dc2626] font-bold px-8 py-4 rounded-xl transition-all hover:scale-105"
        style="font-family: 'Signika', sans-serif;"
      >
        Explore All Ramadan Giving
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
        </svg>
      </a>
    </div>
  </section>

  <Footer />
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const daysButtons = document.querySelectorAll('.kaffarah-days-btn');
    const customDaysInput = document.getElementById('kaffarah-custom-days') as HTMLInputElement;
    const totalDisplay = document.getElementById('kaffarah-total');
    const daysDisplay = document.getElementById('kaffarah-days-display');
    const peopleCount = document.getElementById('kaffarah-people-count');
    const addToCartBtn = document.getElementById('kaffarah-add-to-cart');

    const KAFFARAH_RATE = 300;
    const PEOPLE_PER_DAY = 60;
    let selectedDays = 1;

    function updateTotal() {
      const total = selectedDays * KAFFARAH_RATE;
      const people = selectedDays * PEOPLE_PER_DAY;
      if (totalDisplay) totalDisplay.textContent = `$${total.toLocaleString()}`;
      if (daysDisplay) daysDisplay.textContent = selectedDays.toString();
      if (peopleCount) peopleCount.textContent = people.toLocaleString();
    }

    function selectDays(days: number) {
      selectedDays = days;
      daysButtons.forEach(btn => {
        btn.classList.remove('border-[#dc2626]', 'bg-[#dc2626]/10', 'text-[#dc2626]');
        btn.classList.add('border-gray-200', 'text-gray-700');
        if (parseInt(btn.getAttribute('data-days') || '0') === days) {
          btn.classList.add('border-[#dc2626]', 'bg-[#dc2626]/10', 'text-[#dc2626]');
          btn.classList.remove('border-gray-200', 'text-gray-700');
        }
      });
      updateTotal();
    }

    daysButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const days = parseInt(btn.getAttribute('data-days') || '1');
        if (customDaysInput) customDaysInput.value = '';
        selectDays(days);
      });
    });

    customDaysInput?.addEventListener('input', () => {
      const days = parseInt(customDaysInput.value) || 1;
      selectedDays = Math.max(1, days);
      daysButtons.forEach(btn => {
        btn.classList.remove('border-[#dc2626]', 'bg-[#dc2626]/10', 'text-[#dc2626]');
        btn.classList.add('border-gray-200', 'text-gray-700');
      });
      updateTotal();
    });

    addToCartBtn?.addEventListener('click', () => {
      const total = selectedDays * KAFFARAH_RATE;

      if (typeof (window as any).addToCart === 'function') {
        (window as any).addToCart({
          id: `kaffarah-${selectedDays}-${Date.now()}`,
          type: 'donation',
          name: 'Kaffarah',
          amount: total,
          quantity: 1,
          description: `${selectedDays} day(s) - Feeds ${selectedDays * PEOPLE_PER_DAY} people`,
          frequency: 'single'
        });
      }
    });

    // Initialize
    updateTotal();
  });
</script>
