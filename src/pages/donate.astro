---
/**
 * Donate Page - High-Conversion Donation Experience
 * Designed to maximize donor conversions with:
 * - Clear visual hierarchy
 * - Trust indicators
 * - Easy fund selection
 * - Flexible amount options
 * - Minimal friction checkout
 */
export const prerender = false;

import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
import { supabaseAdmin } from '../lib/supabase';

// Fetch active campaigns grouped by category
const { data: campaigns } = await supabaseAdmin
  .from('campaigns')
  .select('id, name, slug, category, short_description, image_url, goal_amount, raised_amount')
  .eq('is_active', true)
  .order('sort_order', { ascending: true });

// Fetch categories
const { data: categories } = await supabaseAdmin
  .from('categories')
  .select('*')
  .eq('is_active', true)
  .order('sort_order', { ascending: true });

// Group campaigns by category
const campaignsByCategory: Record<string, any[]> = {};
campaigns?.forEach(campaign => {
  const cat = campaign.category || 'general';
  if (!campaignsByCategory[cat]) campaignsByCategory[cat] = [];
  campaignsByCategory[cat].push(campaign);
});

// Featured causes for quick selection
const quickCauses = [
  { id: 'most-needed', label: 'Where Most Needed', icon: 'heart', color: '#ef7c01', description: 'Help where it matters most' },
  { id: 'emergencies', label: 'Emergency Relief', icon: 'emergency', color: '#c41e3a', description: 'Urgent humanitarian aid' },
  { id: 'zakat', label: 'Zakat', icon: 'zakat', color: '#01534d', description: 'Fulfill your obligation' },
  { id: 'water-for-life', label: 'Water Projects', icon: 'water', color: '#0891b2', description: 'Provide clean water' },
  { id: 'orphan-sponsorship', label: 'Orphan Care', icon: 'orphan', color: '#be123c', description: 'Support vulnerable children' },
  { id: 'food-aid', label: 'Feed the Hungry', icon: 'food', color: '#16a34a', description: 'Provide nutritious meals' },
];

// Preset amounts
const presetAmounts = [25, 50, 100, 250, 500, 1000];
---

<Layout title="Donate Now | Qurbani Foundation USA" description="Make a difference today. Your donation provides food, water, healthcare, and education to those in need. 100% Zakat policy.">
  <Navbar />

  <main class="min-h-screen bg-gradient-to-b from-gray-50 to-white">
    <!-- Hero Section with Background Image -->
    <section class="relative pt-28 pb-16 md:pt-32 md:pb-20 overflow-hidden">
      <!-- Background Image - Happy African child with clean background -->
      <div class="absolute inset-0">
        <img
          src="https://images.unsplash.com/photo-1542810634-71277d95dcbb?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80"
          alt="Smiling child - hope and joy"
          class="w-full h-full object-cover object-top"
          loading="eager"
        />
        <!-- Gradient Overlay - teal brand color -->
        <div class="absolute inset-0 bg-gradient-to-r from-[#01534d]/90 via-[#01534d]/80 to-[#01534d]/70"></div>
      </div>

      <!-- Islamic Geometric Pattern Border -->
      <div class="absolute bottom-0 left-0 right-0">
        <!-- Main background -->
        <div class="h-12 bg-gray-50"></div>
        <!-- Geometric pattern overlay -->
        <div class="absolute inset-0 flex items-center justify-center overflow-hidden">
          <svg class="w-full h-12" viewBox="0 0 1440 48" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
            <!-- Background -->
            <rect width="1440" height="48" fill="#f9fafb"/>
            <!-- Geometric Islamic pattern -->
            <pattern id="islamicPattern" x="0" y="0" width="48" height="48" patternUnits="userSpaceOnUse">
              <!-- 8-pointed star pattern -->
              <polygon points="24,0 28,10 38,10 30,18 34,28 24,22 14,28 18,18 10,10 20,10" fill="#01534d" opacity="0.08"/>
              <polygon points="24,48 28,38 38,38 30,30 34,20 24,26 14,20 18,30 10,38 20,38" fill="#01534d" opacity="0.08"/>
              <circle cx="24" cy="24" r="3" fill="#01534d" opacity="0.1"/>
              <circle cx="0" cy="24" r="2" fill="#fdc448" opacity="0.3"/>
              <circle cx="48" cy="24" r="2" fill="#fdc448" opacity="0.3"/>
              <circle cx="24" cy="0" r="2" fill="#fdc448" opacity="0.3"/>
              <circle cx="24" cy="48" r="2" fill="#fdc448" opacity="0.3"/>
            </pattern>
            <rect width="1440" height="48" fill="url(#islamicPattern)"/>
            <!-- Top accent line -->
            <line x1="0" y1="1" x2="1440" y2="1" stroke="#01534d" stroke-width="2" opacity="0.2"/>
            <!-- Gold accent line -->
            <line x1="0" y1="3" x2="1440" y2="3" stroke="#fdc448" stroke-width="1" opacity="0.5"/>
          </svg>
        </div>
      </div>

      <!-- Decorative Elements -->
      <div class="absolute top-20 left-10 w-72 h-72 bg-[#fdc448]/10 rounded-full blur-3xl"></div>
      <div class="absolute bottom-0 right-20 w-96 h-96 bg-white/5 rounded-full blur-3xl"></div>

      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <div class="max-w-3xl mx-auto text-center">
          <div class="inline-flex items-center gap-2 bg-white/15 backdrop-blur-sm text-white text-sm font-medium px-4 py-2 rounded-full mb-6 border border-white/20">
            <span class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
            100% Donation Policy on Zakat
          </div>

          <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight drop-shadow-lg" style="font-family: 'Signika', sans-serif;">
            Your Generosity <br class="hidden md:block" /><span class="text-[#fdc448]">Changes Lives</span>
          </h1>

          <p class="text-xl text-white/90 mb-8 max-w-xl mx-auto drop-shadow" style="font-family: 'Lato', sans-serif;">
            Every dollar you give provides food, clean water, healthcare, and hope to families in need across 50+ countries.
          </p>

          <!-- Impact Stats -->
          <div class="flex flex-wrap justify-center gap-6 md:gap-10">
            <div class="text-center">
              <div class="text-4xl md:text-5xl font-bold text-[#fdc448] drop-shadow" style="font-family: 'Signika', sans-serif;">50+</div>
              <div class="text-sm text-white/80 font-medium">Countries Served</div>
            </div>
            <div class="text-center">
              <div class="text-4xl md:text-5xl font-bold text-[#fdc448] drop-shadow" style="font-family: 'Signika', sans-serif;">1M+</div>
              <div class="text-sm text-white/80 font-medium">Lives Transformed</div>
            </div>
            <div class="text-center">
              <div class="text-4xl md:text-5xl font-bold text-[#fdc448] drop-shadow" style="font-family: 'Signika', sans-serif;">25+</div>
              <div class="text-sm text-white/80 font-medium">Years of Service</div>
            </div>
          </div>

        </div>
      </div>

    </section>

    <!-- Main Donation Form -->
    <section class="py-12 relative z-20">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="bg-white rounded-3xl shadow-2xl overflow-hidden">
          <div class="grid lg:grid-cols-5">

            <!-- Left Side - Cause Selection -->
            <div class="lg:col-span-2 bg-gray-50 p-6 lg:p-8">
              <h2 class="text-xl font-bold text-gray-800 mb-6" style="font-family: 'Signika', sans-serif;">
                Choose a Cause
              </h2>

              <!-- Quick Causes -->
              <div class="space-y-3" id="cause-selector">
                {quickCauses.map((cause, index) => (
                  <button
                    type="button"
                    class={`cause-btn w-full flex items-center gap-4 p-4 rounded-xl border-2 transition-all duration-200 text-left ${index === 0 ? 'border-[#01534d] bg-[#01534d]/5' : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'}`}
                    data-cause={cause.id}
                    data-label={cause.label}
                  >
                    <div class="w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0" style={`background-color: ${cause.color}15;`}>
                      {cause.icon === 'heart' && (
                        <svg class="w-6 h-6" style={`color: ${cause.color};`} fill="currentColor" viewBox="0 0 24 24">
                          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                      )}
                      {cause.icon === 'emergency' && (
                        <svg class="w-6 h-6" style={`color: ${cause.color};`} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                        </svg>
                      )}
                      {cause.icon === 'zakat' && (
                        <svg class="w-6 h-6" style={`color: ${cause.color};`} fill="currentColor" viewBox="0 0 24 24">
                          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"/>
                        </svg>
                      )}
                      {cause.icon === 'water' && (
                        <svg class="w-6 h-6" style={`color: ${cause.color};`} fill="currentColor" viewBox="0 0 24 24">
                          <path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8zm0 18c-3.35 0-6-2.57-6-6.2 0-2.34 1.95-5.44 6-9.14 4.05 3.7 6 6.79 6 9.14 0 3.63-2.65 6.2-6 6.2z"/>
                        </svg>
                      )}
                      {cause.icon === 'orphan' && (
                        <svg class="w-6 h-6" style={`color: ${cause.color};`} fill="currentColor" viewBox="0 0 24 24">
                          <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                        </svg>
                      )}
                      {cause.icon === 'food' && (
                        <svg class="w-6 h-6" style={`color: ${cause.color};`} fill="currentColor" viewBox="0 0 24 24">
                          <path d="M18.06 22.99h1.66c.84 0 1.53-.64 1.63-1.46L23 5.05l-5 2v5.17c0 .8-.63 1.44-1.44 1.46l-.17.01c-.58 0-1.08-.35-1.3-.86L14 10.05v12.94h2.28c.15 0 .29-.02.43-.04.14.02.28.04.43.04h.92zm-3.5-17.4L14 10.05l.56 2.28.44.92V5.59l-.44-1v1z"/>
                          <path d="M1 21.99h10.33c.92 0 1.67-.75 1.67-1.67v-6.67H1v8.34zm6.67-15h-4v5.67h4V6.99zm0-5h-4v3.33h4V1.99z"/>
                        </svg>
                      )}
                    </div>
                    <div class="flex-1 min-w-0">
                      <div class="font-semibold text-gray-800" style="font-family: 'Signika', sans-serif;">{cause.label}</div>
                      <div class="text-sm text-gray-500 truncate">{cause.description}</div>
                    </div>
                    <div class="cause-check hidden w-6 h-6 rounded-full bg-[#01534d] text-white flex items-center justify-center flex-shrink-0">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                      </svg>
                    </div>
                  </button>
                ))}

                <!-- More Causes Dropdown -->
                <div class="relative">
                  <button
                    type="button"
                    id="more-causes-btn"
                    class="w-full flex items-center justify-between gap-4 p-4 rounded-xl border-2 border-dashed border-gray-300 hover:border-gray-400 transition-all duration-200 text-left"
                  >
                    <div class="flex items-center gap-4">
                      <div class="w-12 h-12 rounded-xl bg-gray-100 flex items-center justify-center">
                        <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                        </svg>
                      </div>
                      <div>
                        <div class="font-semibold text-gray-600" style="font-family: 'Signika', sans-serif;">More Causes</div>
                        <div class="text-sm text-gray-400">View all campaigns</div>
                      </div>
                    </div>
                    <svg class="w-5 h-5 text-gray-400 transition-transform duration-200" id="more-causes-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                    </svg>
                  </button>

                  <!-- Dropdown Panel -->
                  <div id="more-causes-panel" class="hidden absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-xl border border-gray-200 z-50 max-h-64 overflow-y-auto">
                    {categories?.map(cat => (
                      <button
                        type="button"
                        class="cause-btn w-full flex items-center gap-3 p-3 hover:bg-gray-50 transition text-left border-b border-gray-100 last:border-0"
                        data-cause={cat.slug}
                        data-label={cat.label}
                      >
                        <div class="w-8 h-8 rounded-lg flex items-center justify-center" style={`background-color: ${cat.color}20;`}>
                          <div class="w-3 h-3 rounded-full" style={`background-color: ${cat.color};`}></div>
                        </div>
                        <span class="font-medium text-gray-700">{cat.label}</span>
                      </button>
                    ))}
                  </div>
                </div>
              </div>

              <!-- Trust Badges -->
              <div class="mt-8 pt-6 border-t border-gray-200">
                <div class="flex items-center justify-center gap-4 text-sm text-gray-500">
                  <div class="flex items-center gap-1">
                    <svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/>
                    </svg>
                    <span>Secure</span>
                  </div>
                  <div class="flex items-center gap-1">
                    <svg class="w-5 h-5 text-blue-500" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58V19z"/>
                    </svg>
                    <span>501(c)(3)</span>
                  </div>
                  <div class="flex items-center gap-1">
                    <svg class="w-5 h-5 text-amber-500" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                    </svg>
                    <span>Trusted</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Right Side - Amount & Checkout -->
            <div class="lg:col-span-3 p-6 lg:p-8">
              <form id="donation-form" class="space-y-6">
                <!-- Selected Cause Display -->
                <div class="flex items-center justify-between bg-[#01534d]/5 rounded-xl p-4">
                  <div>
                    <div class="text-sm text-gray-500">Donating to</div>
                    <div id="selected-cause-label" class="text-lg font-bold text-[#01534d]" style="font-family: 'Signika', sans-serif;">Where Most Needed</div>
                  </div>
                  <button type="button" id="change-cause-btn" class="text-sm text-[#01534d] hover:underline font-medium">Change</button>
                  <input type="hidden" name="cause" id="selected-cause" value="most-needed" />
                </div>

                <!-- Frequency Toggle -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-3">Donation Type</label>
                  <div class="grid grid-cols-2 gap-3">
                    <button
                      type="button"
                      class="freq-btn active relative flex items-center justify-center gap-2 p-4 rounded-xl border-2 border-[#01534d] bg-[#01534d] text-white font-semibold transition-all duration-200"
                      data-frequency="single"
                    >
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                      </svg>
                      One-Time Gift
                    </button>
                    <button
                      type="button"
                      class="freq-btn relative flex items-center justify-center gap-2 p-4 rounded-xl border-2 border-gray-200 bg-white text-gray-700 font-semibold transition-all duration-200 hover:border-gray-300"
                      data-frequency="monthly"
                    >
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                      </svg>
                      Monthly
                      <span class="absolute -top-2 -right-2 bg-[#fdc448] text-[#61470e] text-xs font-bold px-2 py-0.5 rounded-full">Popular</span>
                    </button>
                  </div>
                  <input type="hidden" name="frequency" id="selected-frequency" value="single" />
                </div>

                <!-- Amount Selection -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-3">Select Amount</label>
                  <div class="grid grid-cols-3 gap-3 mb-4">
                    {presetAmounts.map((amount) => (
                      <button
                        type="button"
                        class="amount-btn relative p-4 rounded-xl border-2 font-bold text-lg transition-all duration-200 border-gray-200 bg-white text-gray-700 hover:border-gray-300"
                        data-amount={amount}
                        style="font-family: 'Signika', sans-serif;"
                      >
                        ${amount}
                        {amount === 100 && (
                          <span class="absolute -top-2 left-1/2 -translate-x-1/2 bg-[#ef7c01] text-white text-xs font-bold px-2 py-0.5 rounded-full whitespace-nowrap">Most Popular</span>
                        )}
                      </button>
                    ))}
                  </div>

                  <!-- Custom Amount -->
                  <div class="relative">
                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 text-xl font-bold">$</span>
                    <input
                      type="number"
                      id="custom-amount"
                      name="customAmount"
                      min="1"
                      placeholder="Enter custom amount"
                      class="w-full pl-10 pr-4 py-4 text-xl font-bold text-gray-700 bg-gray-50 border-2 border-gray-200 rounded-xl focus:border-[#01534d] focus:ring-2 focus:ring-[#01534d]/20 outline-none transition"
                      style="font-family: 'Signika', sans-serif;"
                    />
                  </div>
                  <input type="hidden" name="amount" id="selected-amount" value="0" />
                </div>

                <!-- Impact Preview -->
                <div id="impact-preview" class="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 border border-amber-200">
                  <div class="flex items-start gap-3">
                    <div class="w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0">
                      <svg class="w-5 h-5 text-amber-600" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                      </svg>
                    </div>
                    <div>
                      <div id="impact-amount" class="font-semibold text-amber-800" style="font-family: 'Signika', sans-serif;">Select an amount to see your impact:</div>
                      <div id="impact-text" class="text-amber-700 text-sm mt-1">Your donation provides food, water, healthcare, and hope to families in need.</div>
                    </div>
                  </div>
                </div>

                <!-- Donate Button -->
                <button
                  type="submit"
                  id="donate-btn"
                  class="w-full bg-gradient-to-r from-[#ef7c01] to-[#fdc448] hover:from-[#d96e00] hover:to-[#efb000] text-white font-bold text-xl py-5 px-8 rounded-xl transition-all duration-200 flex items-center justify-center gap-3 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                  style="font-family: 'Signika', sans-serif;"
                >
                  <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                  </svg>
                  <span id="donate-btn-text">Select Amount to Donate</span>
                </button>

                <!-- Security Note -->
                <div class="flex items-center justify-center gap-4 text-sm text-gray-500">
                  <div class="flex items-center gap-1">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
                    </svg>
                    Secure 256-bit SSL
                  </div>
                  <span class="text-gray-300">|</span>
                  <div class="flex items-center gap-2">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/ba/Stripe_Logo%2C_revised_2016.svg/120px-Stripe_Logo%2C_revised_2016.svg.png" alt="Stripe" class="h-4 opacity-50" />
                  </div>
                </div>
              </form>
            </div>

          </div>
        </div>
      </div>
    </section>

    <!-- Why Donate With Us -->
    <section class="py-16 bg-white">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-800 mb-4" style="font-family: 'Signika', sans-serif;">
            Why Donate With Qurbani Foundation?
          </h2>
          <p class="text-gray-600 max-w-2xl mx-auto">
            Your trust matters. Here's why thousands of donors choose us for their charitable giving.
          </p>
        </div>

        <div class="grid md:grid-cols-4 gap-6">
          <div class="text-center p-6 rounded-2xl bg-gray-50 hover:bg-[#01534d]/5 transition">
            <div class="w-16 h-16 bg-[#01534d]/10 rounded-2xl flex items-center justify-center mx-auto mb-4">
              <svg class="w-8 h-8 text-[#01534d]" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
            </div>
            <h3 class="font-bold text-lg text-gray-800 mb-2" style="font-family: 'Signika', sans-serif;">100% Zakat Policy</h3>
            <p class="text-gray-600 text-sm">Every penny of your Zakat goes directly to those in need.</p>
          </div>

          <div class="text-center p-6 rounded-2xl bg-gray-50 hover:bg-[#01534d]/5 transition">
            <div class="w-16 h-16 bg-[#01534d]/10 rounded-2xl flex items-center justify-center mx-auto mb-4">
              <svg class="w-8 h-8 text-[#01534d]" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>
              </svg>
            </div>
            <h3 class="font-bold text-lg text-gray-800 mb-2" style="font-family: 'Signika', sans-serif;">Tax Deductible</h3>
            <p class="text-gray-600 text-sm">We're a registered 501(c)(3). EIN: 38-4109716</p>
          </div>

          <div class="text-center p-6 rounded-2xl bg-gray-50 hover:bg-[#01534d]/5 transition">
            <div class="w-16 h-16 bg-[#01534d]/10 rounded-2xl flex items-center justify-center mx-auto mb-4">
              <svg class="w-8 h-8 text-[#01534d]" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
              </svg>
            </div>
            <h3 class="font-bold text-lg text-gray-800 mb-2" style="font-family: 'Signika', sans-serif;">Global Reach</h3>
            <p class="text-gray-600 text-sm">Serving communities in 50+ countries worldwide.</p>
          </div>

          <div class="text-center p-6 rounded-2xl bg-gray-50 hover:bg-[#01534d]/5 transition">
            <div class="w-16 h-16 bg-[#01534d]/10 rounded-2xl flex items-center justify-center mx-auto mb-4">
              <svg class="w-8 h-8 text-[#01534d]" fill="currentColor" viewBox="0 0 24 24">
                <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM10 17l-3.5-3.5 1.41-1.41L10 14.17l4.59-4.59L16 11l-6 6z"/>
              </svg>
            </div>
            <h3 class="font-bold text-lg text-gray-800 mb-2" style="font-family: 'Signika', sans-serif;">Transparent</h3>
            <p class="text-gray-600 text-sm">Track your impact with regular updates and reports.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Testimonials -->
    <section class="py-16 bg-[#01534d]">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-white mb-4" style="font-family: 'Signika', sans-serif;">
            What Our Donors Say
          </h2>
        </div>

        <div class="grid md:grid-cols-3 gap-6">
          <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6">
            <div class="flex gap-1 mb-4">
              {[1,2,3,4,5].map(() => (
                <svg class="w-5 h-5 text-[#fdc448]" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                </svg>
              ))}
            </div>
            <p class="text-white/90 mb-4">"I've been donating monthly for 3 years. The transparency and regular updates give me complete confidence my money is making a real difference."</p>
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-white font-bold">A</div>
              <div>
                <div class="font-semibold text-white">Ahmed K.</div>
                <div class="text-white/60 text-sm">Monthly Donor</div>
              </div>
            </div>
          </div>

          <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6">
            <div class="flex gap-1 mb-4">
              {[1,2,3,4,5].map(() => (
                <svg class="w-5 h-5 text-[#fdc448]" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                </svg>
              ))}
            </div>
            <p class="text-white/90 mb-4">"The Zakat calculator made it so easy to fulfill my obligation. Knowing 100% goes to those in need means everything to me."</p>
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-white font-bold">F</div>
              <div>
                <div class="font-semibold text-white">Fatima M.</div>
                <div class="text-white/60 text-sm">Zakat Donor</div>
              </div>
            </div>
          </div>

          <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6">
            <div class="flex gap-1 mb-4">
              {[1,2,3,4,5].map(() => (
                <svg class="w-5 h-5 text-[#fdc448]" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                </svg>
              ))}
            </div>
            <p class="text-white/90 mb-4">"Our company partners with Qurbani Foundation for corporate giving. Their professionalism and impact reporting is exceptional."</p>
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-white font-bold">J</div>
              <div>
                <div class="font-semibold text-white">James R.</div>
                <div class="text-white/60 text-sm">Corporate Partner</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Other Ways to Give -->
    <section class="py-16 bg-gray-50">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-800 mb-4" style="font-family: 'Signika', sans-serif;">
            Other Ways to Give
          </h2>
        </div>

        <div class="grid md:grid-cols-3 gap-6">
          <a href="/zakat-calculator" class="group bg-white rounded-2xl p-6 shadow-sm hover:shadow-lg transition">
            <div class="w-14 h-14 bg-[#01534d]/10 rounded-xl flex items-center justify-center mb-4 group-hover:bg-[#01534d] transition">
              <svg class="w-7 h-7 text-[#01534d] group-hover:text-white transition" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
              </svg>
            </div>
            <h3 class="font-bold text-lg text-gray-800 mb-2" style="font-family: 'Signika', sans-serif;">Zakat Calculator</h3>
            <p class="text-gray-600 text-sm mb-3">Calculate your Zakat obligation with live gold & silver prices.</p>
            <span class="text-[#01534d] font-medium text-sm group-hover:underline">Calculate Now →</span>
          </a>

          <a href="tel:18009000027" class="group bg-white rounded-2xl p-6 shadow-sm hover:shadow-lg transition">
            <div class="w-14 h-14 bg-[#01534d]/10 rounded-xl flex items-center justify-center mb-4 group-hover:bg-[#01534d] transition">
              <svg class="w-7 h-7 text-[#01534d] group-hover:text-white transition" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
              </svg>
            </div>
            <h3 class="font-bold text-lg text-gray-800 mb-2" style="font-family: 'Signika', sans-serif;">Donate by Phone</h3>
            <p class="text-gray-600 text-sm mb-3">Call our team for personalized donation assistance.</p>
            <span class="text-[#01534d] font-medium text-sm group-hover:underline">1-800-900-0027 →</span>
          </a>

          <a href="/contact" class="group bg-white rounded-2xl p-6 shadow-sm hover:shadow-lg transition">
            <div class="w-14 h-14 bg-[#01534d]/10 rounded-xl flex items-center justify-center mb-4 group-hover:bg-[#01534d] transition">
              <svg class="w-7 h-7 text-[#01534d] group-hover:text-white transition" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
              </svg>
            </div>
            <h3 class="font-bold text-lg text-gray-800 mb-2" style="font-family: 'Signika', sans-serif;">Corporate Giving</h3>
            <p class="text-gray-600 text-sm mb-3">Partner with us for employee giving and CSR programs.</p>
            <span class="text-[#01534d] font-medium text-sm group-hover:underline">Contact Us →</span>
          </a>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Elements
    const form = document.getElementById('donation-form') as HTMLFormElement;
    const causeBtns = document.querySelectorAll('.cause-btn');
    const freqBtns = document.querySelectorAll('.freq-btn');
    const amountBtns = document.querySelectorAll('.amount-btn');
    const customAmountInput = document.getElementById('custom-amount') as HTMLInputElement;
    const selectedCauseInput = document.getElementById('selected-cause') as HTMLInputElement;
    const selectedCauseLabel = document.getElementById('selected-cause-label');
    const selectedFreqInput = document.getElementById('selected-frequency') as HTMLInputElement;
    const selectedAmountInput = document.getElementById('selected-amount') as HTMLInputElement;
    const donateBtnText = document.getElementById('donate-btn-text');
    const donateBtn = document.getElementById('donate-btn') as HTMLButtonElement;
    const impactAmount = document.getElementById('impact-amount');
    const impactText = document.getElementById('impact-text');
    const moreCausesBtn = document.getElementById('more-causes-btn');
    const moreCausesPanel = document.getElementById('more-causes-panel');
    const moreCausesArrow = document.getElementById('more-causes-arrow');
    const changeCauseBtn = document.getElementById('change-cause-btn');

    let selectedAmount = 0; // No default selection
    let selectedFrequency = 'single';
    let selectedCause = 'most-needed';

    // Impact messages based on amount
    const getImpactMessage = (amount: number) => {
      if (amount < 25) return 'Provide essential supplies for a family in need.';
      if (amount < 50) return 'Feed a family for a week with nutritious meals.';
      if (amount < 100) return 'Provide clean water access for a village for a week.';
      if (amount < 250) return 'Clean water for 5 families for a month, or 200 nutritious meals for children.';
      if (amount < 500) return 'Support an orphan for a month with food, education, and healthcare.';
      if (amount < 1000) return 'Fund a cataract surgery to restore someone\'s sight, changing their life forever.';
      return 'Build a water well providing clean water to an entire community for years to come.';
    };

    // Update button text and impact preview
    const updateButtonText = () => {
      const freqText = selectedFrequency === 'monthly' ? '/month' : '';
      if (selectedAmount > 0) {
        donateBtnText!.textContent = `Donate $${selectedAmount}${freqText} Now`;
        impactAmount!.textContent = `Your $${selectedAmount} can provide:`;
        impactText!.textContent = getImpactMessage(selectedAmount);
      } else {
        donateBtnText!.textContent = 'Select Amount to Donate';
        impactAmount!.textContent = 'Select an amount to see your impact:';
        impactText!.textContent = 'Your donation provides food, water, healthcare, and hope to families in need.';
      }
    };

    // Cause selection
    causeBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const cause = (btn as HTMLElement).dataset.cause;
        const label = (btn as HTMLElement).dataset.label;

        // Update active state
        causeBtns.forEach(b => {
          b.classList.remove('border-[#01534d]', 'bg-[#01534d]/5');
          b.classList.add('border-gray-200');
          b.querySelector('.cause-check')?.classList.add('hidden');
        });
        btn.classList.remove('border-gray-200');
        btn.classList.add('border-[#01534d]', 'bg-[#01534d]/5');
        btn.querySelector('.cause-check')?.classList.remove('hidden');

        selectedCause = cause || 'most-needed';
        selectedCauseInput!.value = selectedCause;
        selectedCauseLabel!.textContent = label || 'Where Most Needed';

        // Close dropdown if open
        moreCausesPanel?.classList.add('hidden');
        moreCausesArrow?.classList.remove('rotate-180');
      });
    });

    // More causes dropdown
    moreCausesBtn?.addEventListener('click', () => {
      moreCausesPanel?.classList.toggle('hidden');
      moreCausesArrow?.classList.toggle('rotate-180');
    });

    // Close dropdown on outside click
    document.addEventListener('click', (e) => {
      if (!moreCausesBtn?.contains(e.target as Node) && !moreCausesPanel?.contains(e.target as Node)) {
        moreCausesPanel?.classList.add('hidden');
        moreCausesArrow?.classList.remove('rotate-180');
      }
    });

    // Scroll to cause selector
    changeCauseBtn?.addEventListener('click', () => {
      document.getElementById('cause-selector')?.scrollIntoView({ behavior: 'smooth' });
    });

    // Frequency selection
    freqBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        freqBtns.forEach(b => {
          b.classList.remove('border-[#01534d]', 'bg-[#01534d]', 'text-white');
          b.classList.add('border-gray-200', 'bg-white', 'text-gray-700');
        });
        btn.classList.remove('border-gray-200', 'bg-white', 'text-gray-700');
        btn.classList.add('border-[#01534d]', 'bg-[#01534d]', 'text-white');

        selectedFrequency = (btn as HTMLElement).dataset.frequency || 'single';
        selectedFreqInput!.value = selectedFrequency;
        updateButtonText();
      });
    });

    // Amount selection
    amountBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        amountBtns.forEach(b => {
          b.classList.remove('border-[#01534d]', 'bg-[#01534d]', 'text-white');
          b.classList.add('border-gray-200', 'bg-white', 'text-gray-700');
        });
        btn.classList.remove('border-gray-200', 'bg-white', 'text-gray-700');
        btn.classList.add('border-[#01534d]', 'bg-[#01534d]', 'text-white');

        selectedAmount = parseInt((btn as HTMLElement).dataset.amount || '100');
        selectedAmountInput!.value = selectedAmount.toString();
        customAmountInput!.value = '';
        updateButtonText();
      });
    });

    // Custom amount
    customAmountInput?.addEventListener('input', () => {
      if (customAmountInput.value) {
        amountBtns.forEach(b => {
          b.classList.remove('border-[#01534d]', 'bg-[#01534d]', 'text-white');
          b.classList.add('border-gray-200', 'bg-white', 'text-gray-700');
        });
        selectedAmount = parseInt(customAmountInput.value) || 0;
        selectedAmountInput!.value = selectedAmount.toString();
        updateButtonText();
      }
    });

    // Form submission - Add to cart and open cart modal
    form?.addEventListener('submit', async (e) => {
      e.preventDefault();

      if (selectedAmount <= 0) {
        alert('Please select or enter a donation amount');
        return;
      }

      const causeLabel = selectedCauseLabel?.textContent || 'Where Most Needed';
      const itemId = `donate-${selectedCause}-${selectedAmount}-${selectedFrequency}`;

      // Add to cart using global cart function
      if (typeof window.addToCart === 'function') {
        window.addToCart({
          id: itemId,
          name: causeLabel,
          label: `$${selectedAmount} ${selectedFrequency === 'monthly' ? 'Monthly' : 'One-Time'} Donation`,
          amount: selectedAmount,
          quantity: 1,
          type: selectedFrequency,
          image: 'https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?w=400',
          campaign: selectedCause
        });
      } else {
        console.error('Cart not available');
        alert('Cart is not available. Please refresh the page and try again.');
      }
    });

    // Initialize
    updateButtonText();
  });
</script>

<style>
  .cause-btn.active .cause-check {
    display: flex !important;
  }

  /* Custom scrollbar for more causes panel */
  #more-causes-panel::-webkit-scrollbar {
    width: 6px;
  }

  #more-causes-panel::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 3px;
  }

  #more-causes-panel::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 3px;
  }

  #more-causes-panel::-webkit-scrollbar-thumb:hover {
    background: #a1a1a1;
  }
</style>
